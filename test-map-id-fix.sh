#!/bin/bash

echo "üß™ Testando corre√ß√£o do ID do mapa..."
echo ""

# Verificar se o servidor est√° rodando
echo "üîç Verificando se o servidor est√° rodando..."
if curl -s http://localhost:5176/ > /dev/null; then
    echo "‚úÖ Servidor Operator UI est√° rodando em http://localhost:5176/"
else
    echo "‚ùå Servidor Operator UI n√£o est√° rodando"
    echo "üí° Execute: cd citrineos-operator-ui && npm run dev"
    exit 1
fi

echo ""
echo "üéØ Teste da Corre√ß√£o do ID do Mapa:"
echo ""
echo "1. Acesse: http://localhost:5176/"
echo "2. Fa√ßa login com:"
echo "   - Email: admin@citrineos.com"
echo "   - Senha: CitrineOS!"
echo ""
echo "3. Abra o DevTools (F12) e v√° para a aba Console"
echo ""
echo "4. V√° para: Locations ‚Üí Map"
echo ""
echo "5. Verifique se:"
echo "   - ‚úÖ N√ÉO aparece mais o erro: 'O mapa √© inicializado sem um ID de mapa v√°lido'"
echo "   - ‚úÖ O mapa carrega corretamente"
echo "   - ‚úÖ Os marcadores aparecem (se houver localiza√ß√µes)"
echo ""
echo "6. V√° para: Locations ‚Üí Create Location"
echo ""
echo "7. Verifique se:"
echo "   - ‚úÖ O mapa do seletor de localiza√ß√£o carrega"
echo "   - ‚úÖ N√ÉO h√° erros no console"
echo "   - ‚úÖ √â poss√≠vel clicar no mapa para selecionar localiza√ß√£o"
echo ""
echo "8. V√° para: Locations ‚Üí Editar uma localiza√ß√£o existente"
echo ""
echo "9. Verifique se:"
echo "   - ‚úÖ O mapa mostra as coordenadas atuais"
echo "   - ‚úÖ N√ÉO h√° erros no console"
echo "   - ‚úÖ Os campos de latitude/longitude est√£o preenchidos"
echo ""
echo "üîß Corre√ß√µes Aplicadas:"
echo "   - Adicionado Map IDs no arquivo .env"
echo "   - Modificado c√≥digo para usar mapId apenas se estiver definido"
echo "   - Fallback para mapas sem ID espec√≠fico"
echo "   - Preven√ß√£o de erros de inicializa√ß√£o"
echo ""
echo "üìç Configura√ß√µes Adicionadas:"
echo "   - VITE_GOOGLE_MAPS_LOCATION_PICKER_MAP_ID=citrineos-location-picker"
echo "   - VITE_GOOGLE_MAPS_OVERVIEW_MAP_ID=citrineos-overview"
echo ""
echo "üéâ Se n√£o houver mais erros no console, a corre√ß√£o funcionou!"
echo ""
echo "üí° Esta corre√ß√£o resolve:"
echo "   - Erro de ID de mapa inv√°lido"
echo "   - Problemas com marcadores avan√ßados"
echo "   - Inicializa√ß√£o correta dos mapas"
echo "   - Fallback para mapas sem ID espec√≠fico"
