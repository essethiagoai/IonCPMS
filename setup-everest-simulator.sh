#!/bin/bash

echo "ğŸš€ Configurando Simulador EVerest para Testes Transacionais..."
echo ""

# Verificar se o CitrineOS estÃ¡ rodando
echo "ğŸ” Verificando se o CitrineOS estÃ¡ rodando..."
if curl -s http://localhost:8080/docs > /dev/null; then
    echo "âœ… CitrineOS estÃ¡ rodando em http://localhost:8080"
else
    echo "âŒ CitrineOS nÃ£o estÃ¡ rodando"
    echo "ğŸ’¡ Execute: ./setup-citrineos.sh primeiro"
    exit 1
fi

echo ""
echo "ğŸ“‹ Passos para configurar o EVerest Simulator:"
echo ""
echo "1. ğŸ“¥ Clone o repositÃ³rio EVerest Demo:"
echo "   git clone https://github.com/EVerest/everest-demo.git"
echo "   cd everest-demo"
echo ""
echo "2. ğŸ”§ Configure o EVerest para conectar ao CitrineOS:"
echo "   # Edite o arquivo docker-compose.ocpp201.yml"
echo "   # Altere a variÃ¡vel EVEREST_TARGET_URL para:"
echo "   EVEREST_TARGET_URL=http://host.docker.internal:8080"
echo ""
echo "3. ğŸƒ Execute o EVerest:"
echo "   docker compose --project-name everest-ac-demo --file docker-compose.ocpp201.yml up -d"
echo ""
echo "4. ğŸ“Š Acesse as interfaces:"
echo "   - EVerest UI: http://localhost:1880/ui/"
echo "   - NodeRed UI: http://localhost:1880/"
echo "   - OCPP Logs: http://localhost:8888/"
echo ""
echo "5. ğŸ® Simule eventos de carregamento:"
echo "   - Plug/Unplug do veÃ­culo"
echo "   - Start/Stop de transaÃ§Ãµes"
echo "   - Pause/Resume de carregamento"
echo "   - MudanÃ§as de status do carregador"
echo ""
echo "ğŸ’¡ O EVerest simula um carregador real com OCPP 2.0.1"
echo "   e permite testar todas as funcionalidades transacionais!"
echo ""
echo "ğŸ¯ Funcionalidades que vocÃª pode testar:"
echo "   âœ… InÃ­cio de transaÃ§Ãµes"
echo "   âœ… Parada de transaÃ§Ãµes"
echo "   âœ… Pausa/Retomada"
echo "   âœ… Monitoramento em tempo real"
echo "   âœ… RelatÃ³rios de energia"
echo "   âœ… Status do carregador"
echo "   âœ… AutorizaÃ§Ãµes"
echo "   âœ… TarifaÃ§Ã£o"
